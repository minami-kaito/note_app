import{r as f,j as M,a}from"./main.0c370d41.js";function z(d,g,m){return Math.min(Math.max(d,g),m)}const r={east:1<<0,north:1<<3,south:1<<1,west:1<<2};function k({onResizeStart:d,onResizeEnd:g,buttonRef:m,imageRef:p,maxWidth:P,editor:v,showCaption:b,setShowCaption:N,captionsEnabled:C}){const w=f.exports.useRef(null),h=f.exports.useRef({priority:"",value:"default"}),y=f.exports.useRef({currentHeight:0,currentWidth:0,direction:0,isResizing:!1,ratio:0,startHeight:0,startWidth:0,startX:0,startY:0}),c=v.getRootElement(),x=P||(c!==null?c.getBoundingClientRect().width-20:100),E=c!==null?c.getBoundingClientRect().height-20:100,W=100,X=100,$=t=>{const s=t===r.east||t===r.west,e=t===r.north||t===r.south,u=t&r.north&&t&r.west||t&r.south&&t&r.east,o=s?"ew":e?"ns":u?"nwse":"nesw";c!==null&&c.style.setProperty("cursor",`${o}-resize`,"important"),document.body!==null&&(document.body.style.setProperty("cursor",`${o}-resize`,"important"),h.current.value=document.body.style.getPropertyValue("-webkit-user-select"),h.current.priority=document.body.style.getPropertyPriority("-webkit-user-select"),document.body.style.setProperty("-webkit-user-select","none","important"))},L=()=>{c!==null&&c.style.setProperty("cursor","text"),document.body!==null&&(document.body.style.setProperty("cursor","default"),document.body.style.setProperty("-webkit-user-select",h.current.value,h.current.priority))},l=(t,s)=>{if(!v.isEditable())return;const e=p.current,u=w.current;if(e!==null&&u!==null){const{width:o,height:i}=e.getBoundingClientRect(),n=y.current;n.startWidth=o,n.startHeight=i,n.ratio=o/i,n.currentWidth=o,n.currentHeight=i,n.startX=t.clientX,n.startY=t.clientY,n.isResizing=!0,n.direction=s,$(s),d(),u.classList.add("image-control-wrapper--resizing"),e.style.height=`${i}px`,e.style.width=`${o}px`,document.addEventListener("pointermove",R),document.addEventListener("pointerup",H)}},R=t=>{const s=p.current,e=y.current,u=e.direction&(r.east|r.west),o=e.direction&(r.south|r.north);if(s!==null&&e.isResizing)if(u&&o){let i=Math.floor(e.startX-t.clientX);i=e.direction&r.east?-i:i;const n=z(e.startWidth+i,W,x),D=n/e.ratio;s.style.width=`${n}px`,s.style.height=`${D}px`,e.currentHeight=D,e.currentWidth=n}else if(o){let i=Math.floor(e.startY-t.clientY);i=e.direction&r.south?-i:i;const n=z(e.startHeight+i,X,E);s.style.height=`${n}px`,e.currentHeight=n}else{let i=Math.floor(e.startX-t.clientX);i=e.direction&r.east?-i:i;const n=z(e.startWidth+i,W,x);s.style.width=`${n}px`,e.currentWidth=n}},H=()=>{const t=p.current,s=y.current,e=w.current;if(t!==null&&e!==null&&s.isResizing){const u=s.currentWidth,o=s.currentHeight;s.startWidth=0,s.startHeight=0,s.ratio=0,s.startX=0,s.startY=0,s.currentWidth=0,s.currentHeight=0,s.isResizing=!1,e.classList.remove("image-control-wrapper--resizing"),L(),g(u,o),document.removeEventListener("pointermove",R),document.removeEventListener("pointerup",H)}};return M("div",{ref:w,children:[!b&&C&&a("button",{className:"image-caption-button",ref:m,onClick:()=>{N(!b)},children:"Add Caption"}),a("div",{className:"image-resizer image-resizer-n",onPointerDown:t=>{l(t,r.north)}}),a("div",{className:"image-resizer image-resizer-ne",onPointerDown:t=>{l(t,r.north|r.east)}}),a("div",{className:"image-resizer image-resizer-e",onPointerDown:t=>{l(t,r.east)}}),a("div",{className:"image-resizer image-resizer-se",onPointerDown:t=>{l(t,r.south|r.east)}}),a("div",{className:"image-resizer image-resizer-s",onPointerDown:t=>{l(t,r.south)}}),a("div",{className:"image-resizer image-resizer-sw",onPointerDown:t=>{l(t,r.south|r.west)}}),a("div",{className:"image-resizer image-resizer-w",onPointerDown:t=>{l(t,r.west)}}),a("div",{className:"image-resizer image-resizer-nw",onPointerDown:t=>{l(t,r.north|r.west)}})]})}export{k as I};
