import{r as s,j as f,a as t,u as N,$ as q,b as x,m as C,K as _,C as g,S,c as h,d as $,F as v,E as M,e as k}from"./main.0c370d41.js";function b({equation:r,setEquation:c,inline:i},e){const a=E=>{c(E.target.value)};return i&&e instanceof HTMLInputElement?f("span",{className:"EquationEditor_inputBackground",children:[t("span",{className:"EquationEditor_dollarSign",children:"$"}),t("input",{className:"EquationEditor_inlineEditor",value:r,onChange:a,autoFocus:!0,ref:e}),t("span",{className:"EquationEditor_dollarSign",children:"$"})]}):f("div",{className:"EquationEditor_inputBackground",children:[t("span",{className:"EquationEditor_dollarSign",children:`$$
`}),t("textarea",{className:"EquationEditor_blockEditor",value:r,onChange:a,ref:e}),t("span",{className:"EquationEditor_dollarSign",children:`
$$`})]})}var A=s.exports.forwardRef(b);function I({equation:r,inline:c,nodeKey:i}){const[e]=N(),[a,E]=s.exports.useState(r),[u,d]=s.exports.useState(!1),m=s.exports.useRef(null),p=s.exports.useCallback(o=>{d(!1),e.update(()=>{const n=q(i);x(n)&&(n.setEquation(a),o&&n.selectNext(0,0))})},[e,a,i]);return s.exports.useEffect(()=>{!u&&a!==r&&E(r)},[u,r,a]),s.exports.useEffect(()=>u?C(e.registerCommand(S,o=>{const n=document.activeElement;return m.current!==n&&p(),!1},g),e.registerCommand(_,o=>{const n=document.activeElement;return m.current===n?(p(!0),!0):!1},g)):e.registerUpdateListener(({editorState:o})=>{o.read(()=>{const l=h();return $(l)&&l.has(i)&&l.getNodes().length===1})&&d(!0)}),[e,i,p,u]),t(v,{children:u?t(A,{equation:a,setEquation:E,inline:c,ref:m}):t(M,{onError:o=>e._onError(o),fallback:null,children:t(k,{equation:a,inline:c,onDoubleClick:()=>d(!0)})})})}export{I as default};
