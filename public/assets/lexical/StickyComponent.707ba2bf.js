import{m as O,G as H,c as s,q as o,a1 as c,a2 as w,a3 as F,a4 as W,a5 as X,A as z,a6 as U,a7 as j,a8 as G,a9 as q,aa as L,l as V,ab as _,i as J,ac as Q,ad as S,ae as v,af as Z,ag as ee,ah as te,ai as ne,aj as P,ak as re,al as se,am as ae,an as k,ao as oe,u as N,ap as ie,j as T,F as le,a as g,aq as ce,ar as ue,as as fe,r as D,x as me,H as de,R as Ce,U as ge,V as pe,W as Ee,$ as R,at as y}from"./main.ef29de94.js";import{L as De}from"./LexicalNestedComposer.b813f49c.js";function b(n,a){a.update(()=>{const e=n instanceof KeyboardEvent?null:n.clipboardData,t=s();if(t!==null&&e!=null){n.preventDefault();const i=ae(a);i!==null&&e.setData("text/html",i),e.setData("text/plain",t.getTextContent())}})}function he(n,a){n.preventDefault(),a.update(()=>{const e=s(),t=n instanceof InputEvent||n instanceof KeyboardEvent?null:n.clipboardData;t!=null&&o(e)&&P(t,e)},{tag:"paste"})}function _e(n,a){b(n,a),a.update(()=>{const e=s();o(e)&&e.removeText()})}function Re(n){return O(n.registerCommand(_,e=>{const t=s();return o(t)?(t.deleteCharacter(e),!0):!1},c),n.registerCommand(se,e=>{const t=s();return o(t)?(t.deleteWord(e),!0):!1},c),n.registerCommand(re,e=>{const t=s();return o(t)?(t.deleteLine(e),!0):!1},c),n.registerCommand(ne,e=>{const t=s();if(!o(t))return!1;if(typeof e=="string")t.insertText(e);else{const i=e.dataTransfer;if(i!=null)P(i,t);else{const u=e.data;u&&t.insertText(u)}}return!0},c),n.registerCommand(te,()=>{const e=s();return o(e)?(e.removeText(),!0):!1},c),n.registerCommand(L,e=>{const t=s();return o(t)?(t.insertLineBreak(e),!0):!1},c),n.registerCommand(ee,()=>{const e=s();return o(e)?(e.insertLineBreak(),!0):!1},c),n.registerCommand(Z,e=>{const t=s();if(!o(t))return!1;const i=e,u=i.shiftKey;return S(t,!0)?(i.preventDefault(),v(t,u,!0),!0):!1},c),n.registerCommand(Q,e=>{const t=s();if(!o(t))return!1;const i=e,u=i.shiftKey;return S(t,!1)?(i.preventDefault(),v(t,u,!1),!0):!1},c),n.registerCommand(J,e=>{const t=s();return o(t)?(e.preventDefault(),n.dispatchCommand(_,!0)):!1},c),n.registerCommand(V,e=>{const t=s();return o(t)?(e.preventDefault(),n.dispatchCommand(_,!1)):!1},c),n.registerCommand(z,e=>{const t=s();if(!o(t))return!1;if(e!==null){if((U||j||G)&&q)return!1;e.preventDefault()}return n.dispatchCommand(L,!1)},c),n.registerCommand(X,e=>{const t=s();return o(t)?(b(e,n),!0):!1},c),n.registerCommand(W,e=>{const t=s();return o(t)?(_e(e,n),!0):!1},c),n.registerCommand(F,e=>{const t=s();return o(t)?(he(e,n),!0):!1},c),n.registerCommand(w,e=>{const t=s();return o(t)?(e.preventDefault(),!0):!1},c),n.registerCommand(H,e=>{const t=s();return o(t)?(e.preventDefault(),!0):!1},c))}function ye(n){k(()=>O(Re(n),oe(n)),[n])}function Te({contentEditable:n,placeholder:a,ErrorBoundary:e}){const[t]=N(),i=ie(t,e);return ye(t),T(le,{children:[n,g(Ne,{content:a}),i]})}function Ne({content:n}){const[a]=N(),e=ce(a),t=ue();return e?typeof n=="function"?n(t):n:null}const Me={...fe,paragraph:"StickyEditorTheme__paragraph"};var Ae=Me;function h(n,a){const e=n.style,t=a.rootElementRect,i=t!==null?t.left:0,u=t!==null?t.top:0;e.top=u+a.y+"px",e.left=i+a.x+"px"}function Se({x:n,y:a,nodeKey:e,color:t,caption:i}){const[u]=N(),p=D.exports.useRef(null),E=D.exports.useRef({isDragging:!1,offsetX:0,offsetY:0,rootElementRect:null,x:0,y:0});me(),D.exports.useEffect(()=>{const r=E.current;r.x=n,r.y=a;const f=p.current;f!==null&&h(f,r)},[n,a]),k(()=>{const r=E.current,f=new ResizeObserver(C=>{for(let d=0;d<C.length;d++){const Y=C[d],{target:K}=Y;r.rootElementRect=K.getBoundingClientRect();const x=p.current;x!==null&&h(x,r)}}),l=u.registerRootListener((C,d)=>{d!==null&&f.unobserve(d),C!==null&&f.observe(C)}),m=()=>{const C=u.getRootElement(),d=p.current;C!==null&&d!==null&&(r.rootElementRect=C.getBoundingClientRect(),h(d,r))};return window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m),l()}},[u]),D.exports.useEffect(()=>{const r=p.current;r!==null&&setTimeout(()=>{r.style.setProperty("transition","top 0.3s ease 0s, left 0.3s ease 0s")},500)},[]);const M=r=>{const f=p.current,l=E.current,m=l.rootElementRect;f!==null&&l.isDragging&&m!==null&&(l.x=r.pageX-l.offsetX-m.left,l.y=r.pageY-l.offsetY-m.top,h(f,l))},A=r=>{const f=p.current,l=E.current;f!==null&&(l.isDragging=!1,f.classList.remove("dragging"),u.update(()=>{const m=R(e);y(m)&&m.setPosition(l.x,l.y)})),document.removeEventListener("pointermove",M),document.removeEventListener("pointerup",A)},I=()=>{u.update(()=>{const r=R(e);y(r)&&r.remove()})},$=()=>{u.update(()=>{const r=R(e);y(r)&&r.toggleColor()})},{historyState:B}=de();return g("div",{ref:p,className:"sticky-note-container",children:T("div",{className:`sticky-note ${t}`,onPointerDown:r=>{const f=p.current;if(f==null||r.button===2||r.target!==f.firstChild)return;const l=f,m=E.current;if(l!==null){const{top:C,left:d}=l.getBoundingClientRect();m.offsetX=r.clientX-d,m.offsetY=r.clientY-C,m.isDragging=!0,l.classList.add("dragging"),document.addEventListener("pointermove",M),document.addEventListener("pointerup",A),r.preventDefault()}},children:[g("button",{onClick:I,className:"delete","aria-label":"Delete sticky note",title:"Delete",children:"X"}),g("button",{onClick:$,className:"color","aria-label":"Change sticky note color",title:"Color",children:g("i",{className:"bucket"})}),T(De,{initialEditor:i,initialTheme:Ae,children:[g(Ce,{externalHistoryState:B}),g(Te,{contentEditable:g(ge,{className:"StickyNode__contentEditable"}),placeholder:g(pe,{className:"StickyNode__placeholder",children:"What's up?"}),ErrorBoundary:Ee})]})]})})}export{Se as default};
